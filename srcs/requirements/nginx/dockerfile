FROM debian:bullseye

# Install nginx
RUN apt-get update && apt-get install -y --no-install-recommends nginx && apt-get clean && rm -rf /var/lib/apt/lists/*

# Copy nginx config file
COPY ./conf/nginx.conf /etc/nginx/sites-available/default

# Create symbolic link to enable the site
RUN ln -sf /etc/nginx/sites-available/default /etc/nginx/sites-enabled/default

# SSL setup
RUN mkdir -p /etc/nginx/ssl

# Copy SSL certificates
COPY ./ssl/polmarti.42.fr.crt /etc/nginx/ssl/polmarti.42.fr.crt 
COPY ./ssl/polmarti.42.fr.key /etc/nginx/ssl/polmarti.42.fr.key


# Expose HTTPS port
EXPOSE 443

# Start nginx in foreground mode
CMD ["nginx", "-g", "daemon off;"]

